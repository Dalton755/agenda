<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>CalendÃ¡rio DinÃ¢mico - Agenda</title>
<style>
  body {
    font-family: Arial, sans-serif;
    text-align: center;
    background: #f5f5f5;
    margin: 0;
  }
  h1 {
    margin: 20px 0;
  }
  #calendar {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    gap: 5px;
    max-width: 800px;
    margin: auto;
  }
  .day {
    padding: 15px;
    background: white;
    border-radius: 5px;
    cursor: pointer;
  }
  .day.empty {
    background: transparent;
    cursor: default;
  }
  .day.event {
    background: #ffeb3b;
    font-weight: bold;
  }
  .header {
    font-weight: bold;
    background: #2196f3;
    color: white;
    padding: 10px 0;
    border-radius: 5px;
  }
  #modal {
    display: none;
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    background: rgba(0,0,0,0.5);
    justify-content: center;
    align-items: center;
  }
  #modal-content {
    background: white;
    padding: 20px;
    border-radius: 5px;
    width: 300px;
    text-align: left;
  }
  #close {
    background: #f44336;
    color: white;
    border: none;
    padding: 5px 10px;
    cursor: pointer;
    float: right;
  }
</style>
</head>
<body>

<h1>ðŸ“… Minha Agenda</h1>
<div id="calendar"></div>

<div id="modal">
  <div id="modal-content">
    <button id="close">X</button>
    <h3>Detalhes do Evento</h3>
    <p id="event-details"></p>
  </div>
</div>

<script>
const DEFAULT_SHEET_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vRJ1IlvX9wx200jfaQG-iSTSjcuYMPTxVSoftUnTEX9aawQgq8iSH3ZvvJE9PYSjFUFT4HlI-p7MSXv/pub?gid=55604018&single=true&output=csv";

let events = {};

fetch(DEFAULT_SHEET_URL)
  .then(res => res.text())
  .then(csv => {
    let rows = csv.split("\n").map(r => r.split(","));
    rows.shift(); // Remove cabeÃ§alho
    rows.forEach(r => {
      let date = r[0].trim(); // Coluna Data
      let local = r[1] ? r[1].trim() : "";
      let obs = r[2] ? r[2].trim() : "";
      let hora = r[3] ? r[3].trim() : "";
      if(date) {
        events[date] = {local, obs, hora};
      }
    });
    renderCalendar(new Date());
  });

function renderCalendar(date) {
  const month = date.getMonth();
  const year = date.getFullYear();

  const firstDay = new Date(year, month, 1);
  const lastDay = new Date(year, month + 1, 0);
  const startDay = firstDay.getDay();
  const totalDays = lastDay.getDate();

  const calendar = document.getElementById("calendar");
  calendar.innerHTML = "";

  const weekDays = ["Dom", "Seg", "Ter", "Qua", "Qui", "Sex", "SÃ¡b"];
  weekDays.forEach(d => {
    let div = document.createElement("div");
    div.classList.add("header");
    div.innerText = d;
    calendar.appendChild(div);
  });

  for (let i = 0; i < startDay; i++) {
    let div = document.createElement("div");
    div.classList.add("day", "empty");
    calendar.appendChild(div);
  }

  for (let i = 1; i <= totalDays; i++) {
    let div = document.createElement("div");
    let currentDate = ${i.toString().padStart(2, "0")}/${(month+1).toString().padStart(2, "0")}/${year};
    div.classList.add("day");
    div.innerText = i;

    if (events[currentDate]) {
      div.classList.add("event");
      div.addEventListener("click", () => showEvent(currentDate));
    }

    calendar.appendChild(div);
  }
}

function showEvent(date) {
  document.getElementById("modal").style.display = "flex";
  let ev = events[date];
  document.getElementById("event-details").innerHTML = `
    <strong>Data:</strong> ${date}<br>
    <strong>Local:</strong> ${ev.local}<br>
    <strong>Hora:</strong> ${ev.hora}<br>
    <strong>Obs:</strong> ${ev.obs}
  `;
}

document.getElementById("close").addEventListener("click", () => {
  document.getElementById("modal").style.display = "none";
});
</script>

</body>
</html>